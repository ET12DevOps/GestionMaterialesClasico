@model gestionmateriales.Models.GestionMateriales.Entrada
@{
    ViewBag.Title = "Stock";
}

<br />
<br />
<div class="container-fluid">
    <h2>Entrada</h2>
    <h6>Ingresa material o herramientas al stock del depósito.</h6>
</div>
<br />
<div class="offset-2 col-md-8">
    <div class="card">
        <div class="card-header">
            Material o Herramienta
        </div>
        <div class="card-body">
            @using (@Html.BeginForm("Sumar", "Stock", FormMethod.Post))
    {
        <div class="form row">
            <div class="form-group col-6">
                @Html.LabelFor(model => model.codigoMaterial, "Código Material", new { @class = "control-label" })
                @Html.EditorFor(model => model.codigoMaterial, new { htmlAttributes = new { @class = "form-control", maxlength = 45, id = "codigoMaterial", autofocus = "true", required = "true", onkeyup = "GetMaterial();" } })
            </div>
            <div class="form-group col-6" id="verMaterial"></div>
        </div>
        <div class="form row">
            <div class="form-group col">
                @Html.LabelFor(model => model.cantidad, "Cantidad a Ingresar", new { @class = "control-label" })
                @Html.EditorFor(model => model.cantidad, new { htmlAttributes = new { @class = "form-control", min = 0, required = "true" } })
            </div>
        </div>
        <div class="form row">
            <div class="form-group col">
                @Html.LabelFor(model => model.tipoEntrada, "Tipo de Entrada", new { @class = "control-label" })
                @Html.DropDownList("IdTipoEntrada", null, htmlAttributes: new { @class = "form-control" })
            </div>
        </div>
        <div class="form-row">
            @Html.LabelFor(model => model.codigoDocumento, "Código Documento", new { @class = "control-label" })
            @Html.EditorFor(model => model.codigoDocumento, new { htmlAttributes = new { @class = "form-control", maxlength = 45, id = "codigoMaterial", autofocus = "true", required = "true", onkeyup = "GetMaterial();" } })
        </div>
        <br />
        <div class="row">
            <div class="col-md-3">
                <input id="btn_limpiar" type="reset" class="btn btn-default btn-block" value="Limpiar" data-toggle="tooltip" data-placement="left" title="Vacia los campos del formulario" />
            </div>
            <div class="offset-3 col-md-3">
                <input id="btn_aceptar" type="submit" class="btn btn-primary btn-block" value="Ingresar" data-toggle="tooltip" data-placement="bottom" title="Confirma la operación" />
            </div>
            <div class="col-md-3">
                <input id="btn_cancelar" type="button" class="btn btn-default btn-block" onclick="location.href='/Home/Index'" value="Volver" data-toggle="tooltip" data-placement="right" title="Regresa a la pantalla anterior" />
            </div>
        </div>
}
        </div>
    </div>
    <script type="text/javascript">
        $('#btn_limpiar').tooltip();
        $('#btn_aceptar').tooltip();
        $('#btn_cancelar').tooltip();

        function GetMaterial() {
            if ($('#codigoMaterial').val() != '') {

                var baseURL = window.location.protocol + "//" + window.location.host + "/"
                var request = $.ajax({
                    url: baseURL + "Material/GetMaterial",
                    type: 'GET',
                    data: { codigo: $('#codigoMaterial').val() },
                    contentType: 'application/json; charset=utf-8'
                });

                request.done(function (data) {
                    console.log(data.Response);
                    if (data.Response != '') {
                        $('#verMaterial').html('<p><strong>Código: </strong>' + data.Response[0].codigo + '<br /><strong>Material: </strong>' + data.Response[0].nombre + '</p>');
                    }
                    else {
                        $('#verMaterial').html('<p>No existe el material con el código del material ingresado.</p>');
                    }
                });

                request.fail(function (data) {
                    alert(data.Response);
                });

            }
            else {
                $('#verMaterial').html('');
            }
        }
    </script>
</div>